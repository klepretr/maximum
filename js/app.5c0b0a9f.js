(function(){var e={579:function(e,t,a){"use strict";var r=a(963),o=a(252);const i={class:"container ml-5 mr-5"};function n(e,t,a,r,n,s){const l=(0,o.up)("Banner"),u=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(l,{appName:"Maximum"}),(0,o._)("main",i,[(0,o.Wm)(u)])],64)}var s=a(577),l=a.p+"img/logo.173d1f4e.png";const u=e=>((0,o.dD)("data-v-54db7cb2"),e=e(),(0,o.Cn)(),e),d={class:"header"},c={class:"header_inner"},v={class:"header_logo"},p=u((()=>(0,o._)("img",{class:"logo",src:l},null,-1)));function m(e,t,a,r,i,n){return(0,o.wg)(),(0,o.iD)("header",d,[(0,o._)("span",c,[(0,o._)("span",v,[p,(0,o._)("div",null,(0,s.zw)(e.appName),1)])])])}var f=(0,o.aZ)({props:{appName:String}}),g=a(744);const h=(0,g.Z)(f,[["render",m],["__scopeId","data-v-54db7cb2"]]);var S=h,y=(0,o.aZ)({components:{Banner:S}});const b=(0,g.Z)(y,[["render",n]]);var w=b,_=a(205);(0,_.z)("/maximum/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var D=a(201);const k={class:"home"};function j(e,t,a,r,i,n){const s=(0,o.up)("SearchComponent");return(0,o.wg)(),(0,o.iD)("div",k,[(0,o.Wm)(s)])}const F=e=>((0,o.dD)("data-v-76b34e19"),e=e(),(0,o.Cn)(),e),C={class:"mb-3"},U=F((()=>(0,o._)("h4",{class:"ta-l"},"Recherche de trajets",-1))),A={class:"row-one-grid"},O={class:"departure-grid"},x={for:"from_stations"},N=["disabled","aria-busy"],z=F((()=>(0,o._)("option",{value:"",disabled:"",selected:""},"Départ...",-1))),J={key:0},I=["value"],L=["value"],R={for:"favorite_btn"},q=["disabled","value"],$=F((()=>(0,o._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"star"},[(0,o._)("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})],-1))),Z=[$],G={for:"to_stations"},Y=["disabled"],E=F((()=>(0,o._)("option",{value:"",disabled:"",selected:""},"Arrivée...",-1))),H={key:0},M=["value"],T=["value"],V={class:"row-two-grid mt-5"},K={for:"date"},P={class:"ta-l di-b custom-label"},B=["data-tooltip"],W=["disabled","aria-busy"],Q={id:"results"},X={key:0},ee=F((()=>(0,o._)("progress",null,null,-1))),te={key:1},ae={for:"switch"},re={key:0},oe=F((()=>(0,o._)("article",null,"Pas d'itinéraire disponible",-1))),ie=[oe],ne={key:0,class:"ml-5 ta-l date"};function se(e,t,a,i,n,l){const u=(0,o.up)("JourneyElement");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("section",C,[U,(0,o._)("form",{onSubmit:t[7]||(t[7]=e=>e.preventDefault())},[(0,o._)("div",A,[(0,o._)("div",O,[(0,o._)("label",x,[(0,o.Uk)(" Gare de départ "),(0,o.wy)((0,o._)("select",{onChange:t[0]||(t[0]=(...t)=>e.onChangeDeparture&&e.onChangeDeparture(...t)),disabled:!e.isDepartureReady,"aria-busy":!e.isDepartureReady,"onUpdate:modelValue":t[1]||(t[1]=t=>e.departure=t),id:"from_stations"},[z,e.departureStationsFavorites.length>0?((0,o.wg)(),(0,o.iD)("optgroup",J,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.departureStationsFavorites,(t=>((0,o.wg)(),(0,o.iD)("option",{key:t.name,value:t},(0,s.zw)(e.titleCaseGare(t.name)),9,I)))),128))])):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.departureStationsNotFavorite,(t=>((0,o.wg)(),(0,o.iD)("option",{key:t.name,value:t},(0,s.zw)(e.titleCaseGare(t.name)),9,L)))),128))],40,N),[[r.bM,e.departure]])]),(0,o._)("label",R,[(0,o.Uk)(" ​ "),(0,o._)("button",{disabled:!e.isSearchReadyToStart,id:"favorite_btn",onClick:t[2]||(t[2]=t=>e.handleFavorite(e.departure)),value:e.departure,class:(0,s.C_)({selected:e.departure.favorite})},Z,10,q)])]),(0,o._)("label",G,[(0,o.Uk)(" Gare d'arrivée "),(0,o.wy)((0,o._)("select",{onChange:t[3]||(t[3]=t=>e.onChangeArrival()),disabled:!e.isArrivalReady,"onUpdate:modelValue":t[4]||(t[4]=t=>e.arrival=t),id:"to_stations"},[E,e.arrivalStationsFavorites.length>0?((0,o.wg)(),(0,o.iD)("optgroup",H,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.arrivalStationsFavorites,(t=>((0,o.wg)(),(0,o.iD)("option",{key:t.name,value:t.name},(0,s.zw)(e.titleCaseGare(t.name)),9,M)))),128))])):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.arrivalStationsNotFavorite,(t=>((0,o.wg)(),(0,o.iD)("option",{key:t.name,value:t.name},(0,s.zw)(e.titleCaseGare(t.name)),9,T)))),128))],40,Y),[[r.bM,e.arrival]])])]),(0,o._)("div",V,[(0,o._)("label",K,[(0,o.Uk)(" A partir du "),(0,o.wy)((0,o._)("input",{type:"date",id:"date",name:"date","onUpdate:modelValue":t[5]||(t[5]=t=>e.from_date=t),required:""},null,512),[[r.nr,e.from_date]])]),(0,o._)("label",null,[(0,o._)("small",P,[(0,o.Uk)(" dernière mise à jour des trajets : "),(0,o._)("em",{"data-tooltip":e.lastUpdateDataset?e.lastUpdateDataset.format("LLL"):null},(0,s.zw)(e.humanizeDateDiff(e.lastUpdateDataset)||"indisponible"),9,B)]),(0,o._)("button",{disabled:!e.isSearchReadyToStart,"aria-busy":e.isSearchLoading,onClick:t[6]||(t[6]=(...t)=>e.onClickSearch&&e.onClickSearch(...t)),class:"mt-1"},(0,s.zw)(e.isSearchLoading?"":"Rechercher..."),9,W)])])],32)]),(0,o._)("section",Q,[e.isSearchLoading?((0,o.wg)(),(0,o.iD)("article",X,[ee,(0,o.Uk)(" Recherche en cours... ")])):(0,o.kq)("",!0),e.isSearchReady?((0,o.wg)(),(0,o.iD)("div",te,[(0,o._)("fieldset",null,[(0,o._)("label",ae,[(0,o.wy)((0,o._)("input",{type:"checkbox",id:"switch",name:"switch",role:"switch","onUpdate:modelValue":t[8]||(t[8]=t=>e.showOnlyAvailableJourneys=t)},null,512),[[r.e8,e.showOnlyAvailableJourneys]]),(0,o.Uk)(" Cacher les trajets indisponibles ")])]),0===Object.keys(e.journeysFiltered(e.showOnlyAvailableJourneys)).length?((0,o.wg)(),(0,o.iD)("section",re,ie)):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.journeysFiltered(e.showOnlyAvailableJourneys),((t,a)=>((0,o.wg)(),(0,o.iD)("section",{key:a},[t.length>0?((0,o.wg)(),(0,o.iD)("div",ne,(0,s.zw)(e.humanizeDate(a)),1)):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t,(e=>((0,o.wg)(),(0,o.j4)(u,{key:e.id,journey:e},null,8,["journey"])))),128))])))),128))])):(0,o.kq)("",!0)])],64)}var le=a(907),ue=a(154),de=a(129),ce=a.n(de),ve=a(484),pe=a.n(ve);const me="https://ressources.data.sncf.com/api/",fe=(e,t="aggregates")=>me+`v2/catalog/datasets/${e}${t?"/"+t:""}`,ge="tgvmax",he="Europe/Paris",Se={limit:1e3,offset:0},ye=ue.Z.create({paramsSerializer:e=>ce().stringify(e,{arrayFormat:"repeat"}),timeout:3e3}),be=[{value:"TGV",force:!0},{value:"SNCF",force:!0},{value:"le",force:!1},{value:"la",force:!1},{value:"sur",force:!1},{value:"de",force:!1},{value:"des",force:!1},{value:"CDG2",force:!0},{value:"et",force:!1},{value:"en",force:!1},{value:"les",force:!1}],we=(e,t)=>e.map((e=>({name:e,favorite:t.includes(e)}))),_e=e=>{localStorage&&localStorage.setItem("favoriteStations",JSON.stringify(e))},De=e=>e.aggregations.map((e=>e.origine||e.destination||"Station Name not found")),ke=e=>e.records.map((e=>({...e.record.fields,available:"OUI"===e.record.fields.od_happy_card,id:`${e.record.fields.train_no}${e.record.fields.date}${e.record.fields.origine_iata}`}))),je=e=>pe()(e?.dataset?.metas?.default?.data_processed)||null;Symbol();var Fe=(0,le.MT)({state:{departureStations:[],arrivalStations:[],favoriteStations:[],journeys:[],lastUpdateDataset:null},getters:{getDepartureStations:e=>e.departureStations,getDepartureStationsFavorites:e=>e.departureStations.filter((e=>e.favorite)),getDepartureStationsNotFavorite:e=>e.departureStations.filter((e=>!e.favorite)),getArrivalStations:e=>e.arrivalStations,getArrivalStationsFavorites:e=>e.arrivalStations.filter((e=>e.favorite)),getArrivalStationsNotFavorite:e=>e.arrivalStations.filter((e=>!e.favorite)),getFavoriteStations:e=>e.favoriteStations,getJourneys:e=>e.journeys,getJourneysOnlyAvailables:e=>e.journeys.filter((e=>e.available)),getLastUpdateDataset:e=>e.lastUpdateDataset},mutations:{setDepartureStations(e,t){localStorage&&localStorage.setItem("departureStations",JSON.stringify(t)),e.departureStations=t},setArrivalStations(e,t){e.arrivalStations=t},setLastUpdateDataset(e,t){e.lastUpdateDataset=t},addFavoriteStations(e,t){e.favoriteStations.push(t),_e(e.favoriteStations)},removeFavoriteStations(e,t){e.favoriteStations.includes(t)&&e.favoriteStations.splice(e.favoriteStations.indexOf(t),1),_e(e.favoriteStations)},setFavoriteStations(e,t){e.favoriteStations=t},setJourneys(e,t){e.journeys=t}},actions:{getLastUpdateDataset({commit:e},t={...Se,timezone:he}){return ye.get(fe(ge,null),{params:{...Se,...t}}).then((t=>e("setLastUpdateDataset",je(t.data)))).catch((e=>{e.status||console.error("Network error, no fallback")}))},getDepartureStations({getters:e,commit:t},a={...Se,group_by:"origine"}){return ye.get(fe(ge),{params:{...Se,...a}}).then((a=>t("setDepartureStations",we(De(a.data),e.getFavoriteStations)))).catch((a=>{if(!a.status&&(console.error("Network error, use localStorage if possible as fallback"),localStorage&&localStorage.getItem("departureStations"))){const a=localStorage.getItem("departureStations");a&&t("setDepartureStations",we(JSON.parse(a),e.getFavoriteStations))}}))},getArrivalStations({getters:e,commit:t},a={query:Se,departure:""}){return ye.get(fe(ge),{params:{...Se,...a.query,group_by:"destination",refine:`origine:${a.departure}`}}).then((a=>t("setArrivalStations",we(De(a.data),e.getFavoriteStations)))).catch((a=>{a.status||(console.error("Network error, use departureStation as fallback"),t("setArrivalStations",we(e.getDepartureStations,e.getFavoriteStations)))}))},getFavoriteStations({commit:e}){if(localStorage&&localStorage.getItem("favoriteStations")){const t=localStorage.getItem("favoriteStations");if(t)return void e("setFavoriteStations",JSON.parse(t))}e("setFavoriteStations",[])},getJourneys({commit:e},t=Se){return ye.get(fe(ge,"records"),{params:{...Se,...t}}).then((t=>e("setJourneys",ke(t.data)))).catch((e=>{e.status}))}},modules:{}}),Ce=a(110),Ue=a.n(Ce),Ae=a(176),Oe=a.n(Ae);a(23),pe().extend(Ue()),pe().extend(Oe()),pe().locale("fr");const xe=e=>e.split(" ").map(((e,t)=>{if(!e)return"";const a=e.toLowerCase(),r=be.find((e=>e.value.toLowerCase()===a));return(0!==t||r?.force)&&r?.value||`${a[0].toUpperCase()}${a.substring(1)}`})).join(" "),Ne=["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],ze=["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],Je=e=>{const t=pe()(),a=pe()(e);if(t.isSame(a,"date"))return"aujourd'hui";const r=a.diff(t,"days");return 0===r?"demain":r<6?Ne[a.get("day")]:`${Ne[a.get("day")]} ${a.get("date")} ${ze[a.get("month")]}`},Ie=e=>e?pe()(e).fromNow():null,Le=e=>pe()(e).format("YYYY-MM-DD"),Re=e=>((0,o.dD)("data-v-e8a2109e"),e=e(),(0,o.Cn)(),e),qe={class:"custom-grid"},$e={class:"station"},Ze=Re((()=>(0,o._)("span",{class:"station_label"},"de",-1))),Ge={class:"station_name"},Ye=Re((()=>(0,o._)("div",null,null,-1))),Ee={class:"ta-e mr-3"},He=["data-tooltip"],Me={key:0},Te={key:1},Ve=Re((()=>(0,o._)("div",{class:"spliter"},null,-1))),Ke={class:"ta-e timesheet merge-col-ends"},Pe={class:"station"},Be=Re((()=>(0,o._)("span",{class:"station_label"},"vers",-1))),We={class:"station_name"},Qe={class:"ta-e number merge-col-ends"},Xe={style:{"font-weight":"600"}},et={key:0,class:"ta-l"},tt=Re((()=>(0,o._)("mark",null,"peut ne pas être à jour",-1))),at=Re((()=>(0,o._)("br",null,null,-1))),rt=Re((()=>(0,o._)("br",null,null,-1))),ot=Re((()=>(0,o._)("small",null,[(0,o.Uk)(" La "),(0,o._)("a",{href:"https://ressources.data.sncf.com/explore/dataset/tgvmax/information/"}," source de données "),(0,o.Uk)(" qu'utilise cette application est mise à jour quotidiennement. Veuillez vérifier l'état réel du trajet depuis votre application de réservation. ")],-1)));function it(e,t,a,r,i,n){return(0,o.wg)(),(0,o.iD)("article",{class:(0,s.C_)({disable:!e.journey.available})},[(0,o._)("div",qe,[(0,o._)("div",$e,[Ze,(0,o._)("span",Ge,(0,s.zw)(e.titleCaseGare(e.journey.origine)),1)]),Ye,(0,o._)("div",Ee,[(0,o.Uk)((0,s.zw)(e.journey.available?"disponible":"indisponible")+" ",1),e.journey.available?((0,o.wg)(),(0,o.iD)("a",{key:0,onClick:t[0]||(t[0]=t=>e.moreInfo=!e.moreInfo),class:"ml-1","data-tooltip":e.moreInfo?"fermer":"+ d'infos"},[e.moreInfo?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("sup",Me,"ⓘ")),e.moreInfo?((0,o.wg)(),(0,o.iD)("sup",Te,"☒")):(0,o.kq)("",!0)],8,He)):(0,o.kq)("",!0)]),Ve,(0,o._)("div",Ke,(0,s.zw)(e.journey.heure_depart)+" ➔ "+(0,s.zw)(e.journey.heure_arrivee),1),(0,o._)("div",Pe,[Be,(0,o._)("span",We,(0,s.zw)(e.titleCaseGare(e.journey.destination)),1)]),(0,o._)("div",Qe,[(0,o.Uk)(" train n°"),(0,o._)("span",Xe,(0,s.zw)(e.journey.train_no),1)])]),e.moreInfo?((0,o.wg)(),(0,o.iD)("blockquote",et,[(0,o.Uk)(" La disponibilité de ce trajet "),tt,(0,o.Uk)("."),at,rt,ot])):(0,o.kq)("",!0)],2)}var nt=(0,o.aZ)({name:"JourneyElement",props:{journey:Object},data(){return{selected:this.journey?.selected||!1,moreInfo:!1}},computed:{titleCaseGare:function(){return xe}},methods:{onChangeFavoris(e){console.log({journey:e})}}});const st=(0,g.Z)(nt,[["render",it],["__scopeId","data-v-e8a2109e"]]);var lt=st,ut=(0,o.aZ)({name:"SearchComponent",components:{JourneyElement:lt},mounted(){Fe.dispatch("getDepartureStations").then((()=>{this.isDepartureReady=!0})),Fe.dispatch("getFavoriteStations"),Fe.dispatch("getLastUpdateDataset")},data(){const e={name:"",favorite:!1};return{isDepartureReady:!1,isArrivalReady:!1,isArrivalSelected:!1,isSearchLoading:!1,isSearchReadyToStart:!1,isSearchReady:!1,showOnlyAvailableJourneys:!0,departure:e,arrival:"",from_date:Le(new Date)}},computed:{...(0,le.Se)({departureStations:"getDepartureStations",departureStationsFavorites:"getDepartureStationsFavorites",departureStationsNotFavorite:"getDepartureStationsNotFavorite",arrivalStations:"getArrivalStations",arrivalStationsFavorites:"getArrivalStationsFavorites",arrivalStationsNotFavorite:"getArrivalStationsNotFavorite",journeys:"getJourneys",lastUpdateDataset:"getLastUpdateDataset"}),titleCaseGare:function(){return xe},humanizeDate:function(){return Je},humanizeDateDiff:function(){return Ie}},methods:{onChangeDeparture(){this.isArrivalReady=!1,this.arrival="",this.isSearchReadyToStart=null!=this.departure.name&&""!==this.departure.name.trim(),this.isArrivalSelected=!1,Fe.dispatch("getArrivalStations",{departure:this.departure.name}).then((()=>{this.isArrivalReady=!0}))},onChangeArrival(){this.isArrivalSelected=null!=this.arrival&&""!==this.arrival.trim()},onClickSearch(){this.isSearchLoading=!0,this.isSearchReady=!1;const e=[`origine:${this.departure.name}`];this.arrival&&e.push(`destination:${this.arrival}`);const t={limit:100,offset:0,where:`date >= date'${this.from_date}'`,order_by:"date asc, heure_depart asc",refine:e};Fe.dispatch("getJourneys",t).then((()=>{this.isSearchLoading=!1,this.isSearchReady=!0;var e=document.querySelector("#results");e&&e.scrollIntoView({behavior:"smooth"})}))},journeysFiltered:e=>{const t={},a=Fe.getters[e?"getJourneysOnlyAvailables":"getJourneys"];return a.forEach((e=>{const a=e.date.toString();a in t||(t[a]=[]),t[a].push({...e,selected:!1})})),t},handleFavorite:e=>{e.favorite=!e.favorite,e.favorite?Fe.commit("addFavoriteStations",e.name):Fe.commit("removeFavoriteStations",e.name)}}});const dt=(0,g.Z)(ut,[["render",se],["__scopeId","data-v-76b34e19"]]);var ct=dt,vt=(0,o.aZ)({name:"Home",components:{SearchComponent:ct}});const pt=(0,g.Z)(vt,[["render",j],["__scopeId","data-v-9f4f6d1c"]]);var mt=pt;const ft=[{path:"/",name:"Home",component:mt}],gt=(0,D.p7)({history:(0,D.r5)(),routes:ft});var ht=gt,St=a(346);(0,r.ri)(w).use(Fe).use(ht).use(St.Z,ue.Z).mount("#app")},654:function(){}},t={};function a(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(i.exports,i,i.exports,a),i.loaded=!0,i.exports}a.m=e,function(){a.amdO={}}(),function(){var e=[];a.O=function(t,r,o,i){if(!r){var n=1/0;for(d=0;d<e.length;d++){r=e[d][0],o=e[d][1],i=e[d][2];for(var s=!0,l=0;l<r.length;l++)(!1&i||n>=i)&&Object.keys(a.O).every((function(e){return a.O[e](r[l])}))?r.splice(l--,1):(s=!1,i<n&&(n=i));if(s){e.splice(d--,1);var u=o();void 0!==u&&(t=u)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[r,o,i]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.hmd=function(e){return e=Object.create(e),e.children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e}}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.p="/maximum/"}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,r){var o,i,n=r[0],s=r[1],l=r[2],u=0;if(n.some((function(t){return 0!==e[t]}))){for(o in s)a.o(s,o)&&(a.m[o]=s[o]);if(l)var d=l(a)}for(t&&t(r);u<n.length;u++)i=n[u],a.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return a.O(d)},r=self["webpackChunktgvmax"]=self["webpackChunktgvmax"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=a.O(void 0,[998],(function(){return a(579)}));r=a.O(r)})();
//# sourceMappingURL=app.5c0b0a9f.js.map